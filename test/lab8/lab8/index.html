
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://workshop.thyintresources.com/secretserver-adv/lab8/lab8/">
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.1">
    
    
      
        <title>Custom Discovery - Secret Server Advanced</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25 0 0 1 .25-.25h5.025a.25.25 0 0 1 .177.073l6.25 6.25a.25.25 0 0 1 0 .354l-5.025 5.025a.25.25 0 0 1-.354 0l-6.25-6.25a.25.25 0 0 1-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775zM6 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 0 1 .25-.25h8.5a.25.25 0 0 1 .25.25v7.736a.75.75 0 1 0 1.5 0V1.75A1.75 1.75 0 0 0 11.25 0h-8.5A1.75 1.75 0 0 0 1 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 0 0 0-1.5H2.75a.25.25 0 0 1-.25-.25V1.75zM4.75 4a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-4.5zM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75zm11.774 3.537a.75.75 0 0 0-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 0 0-1.062 1.058l1.943 1.95a.75.75 0 0 0 1.055.008l4.557-4.45z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm6.5-.25A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75zM8 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.489 4.489 0 0 1-.563-1.191 3.833 3.833 0 0 1-.05-2.063 4.636 4.636 0 0 1-2.025-.293.75.75 0 1 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.748.748 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.404 2.404 0 0 1-.507-.441 3.063 3.063 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.753.753 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768a85.08 85.08 0 0 0-.317-.265c-.814-.68-1.75-1.462-2.692-2.619a3.74 3.74 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 1.06-1.06L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm9 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM6.92 6.085c.081-.16.19-.299.34-.398.145-.097.371-.187.74-.187.28 0 .553.087.738.225A.613.613 0 0 1 9 6.25c0 .177-.04.264-.077.318a.956.956 0 0 1-.277.245c-.076.051-.158.1-.258.161l-.007.004a7.728 7.728 0 0 0-.313.195 2.416 2.416 0 0 0-.692.661.75.75 0 0 0 1.248.832.956.956 0 0 1 .276-.245 6.3 6.3 0 0 1 .26-.16l.006-.004c.093-.057.204-.123.313-.195.222-.149.487-.355.692-.662.214-.32.329-.702.329-1.15 0-.76-.36-1.348-.863-1.725A2.76 2.76 0 0 0 8 4c-.631 0-1.155.16-1.572.438-.413.276-.68.638-.849.977a.75.75 0 1 0 1.342.67z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575L6.457 1.047zM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-.25-5.25a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 0 1.5 0v-2.5z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.404 12.596a6.5 6.5 0 1 1 9.192-9.192 6.5 6.5 0 0 1-9.192 9.192zM2.344 2.343a8 8 0 1 0 11.313 11.314A8 8 0 0 0 2.343 2.343zM6.03 4.97a.75.75 0 0 0-1.06 1.06L6.94 8 4.97 9.97a.75.75 0 1 0 1.06 1.06L8 9.06l1.97 1.97a.75.75 0 1 0 1.06-1.06L9.06 8l1.97-1.97a.75.75 0 1 0-1.06-1.06L8 6.94 6.03 4.97z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 0 0-.01.004L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.02.02 0 0 0-.004-.009.02.02 0 0 0-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.492 3.492 0 0 1 2.441 0l.999-1a.75.75 0 1 1 1.06 1.061l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.013 5.013 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.684 1.684 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06zM6.173 5h3.654A.173.173 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173zM5.25 6.5a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75h-5.5z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458L5 5.782zM9.5 2.5h-3V6a.75.75 0 0 1-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6V2.5zm-6.9 9.847L3.775 10.5h8.45l1.175 1.847a.75.75 0 0 1-.633 1.153H3.233a.75.75 0 0 1-.633-1.153z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.75 2.5a.75.75 0 0 0 0 1.5h10.5a.75.75 0 0 0 0-1.5H1.75zm4 5a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5zm0 5a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5zM2.5 7.75a.75.75 0 0 0-1.5 0v6a.75.75 0 0 0 1.5 0v-6z"/></svg>');}</style>

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Manrope:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Manrope";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#custom-discovery" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Secret Server Advanced" class="md-header__button md-logo" aria-label="Secret Server Advanced" data-md-component="logo">
      
  <img src="../../img/Delinea.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Secret Server Advanced
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Custom Discovery
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Secret Server Advanced" class="md-nav__button md-logo" aria-label="Secret Server Advanced" data-md-component="logo">
      
  <img src="../../img/Delinea.svg" alt="logo">

    </a>
    Secret Server Advanced
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab1/lab1/" class="md-nav__link">
        Configure Site Connector
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab2/lab2/" class="md-nav__link">
        Add Site
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab3/lab3/" class="md-nav__link">
        Discovery of the second domain
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab4/lab4/" class="md-nav__link">
        Proxying SSh and RDP
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab5/lab5/" class="md-nav__link">
        Secrets manipulation using folders
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab6/lab6/" class="md-nav__link">
        Teams
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab7/lab7/" class="md-nav__link">
        Hooks in secrets
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Custom Discovery
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Custom Discovery
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-the-powershell-script" class="md-nav__link">
    Create the PowerShell script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-scan-template" class="md-nav__link">
    Create a new scan template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-discovery-scanner" class="md-nav__link">
    Create a new Discovery scanner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-new-discovery-scanner" class="md-nav__link">
    Run the new Discovery Scanner
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab9/lab9/" class="md-nav__link">
        Custom Remote Password Changer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab10/lab10/" class="md-nav__link">
        Disaster Recovery
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lab11/lab11/" class="md-nav__link">
        Summarize the lab
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-the-powershell-script" class="md-nav__link">
    Create the PowerShell script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-scan-template" class="md-nav__link">
    Create a new scan template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-discovery-scanner" class="md-nav__link">
    Create a new Discovery scanner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-new-discovery-scanner" class="md-nav__link">
    Run the new Discovery Scanner
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="custom-discovery">Custom Discovery</h1>
<p>For this part of the lab we are going to Scan for the SQL Server logins that have been defined in the Database that the SSPM server is using. The floowing steps are to be taken:</p>
<ol>
<li>Create a new PowerShell Script</li>
<li>Create a new Scan Template</li>
<li>Create a new Discovery Scanner that uses the Scan Template and the PowerShell script</li>
<li>Run the Discovery scanner</li>
</ol>
<h2 id="create-the-powershell-script">Create the PowerShell script</h2>
<ol>
<li>While still being on the Client VM, navigate to <strong>Administration &gt;&gt; &gt; Actions &gt; Scripts: PowerShell, SQL, SSH</strong></li>
<li>Click <strong>+ Create New</strong></li>
</ol>
<p><img alt="Secret Change" src="../images/ss-adv-0080.png" /></p>
<ol>
<li>Use the following information for the fields:</li>
<li><strong>Name:</strong> SQL Login Discovery</li>
<li><strong>Description:</strong> SQL Login Discovery Scanner</li>
<li><strong>Category:</strong> Discovery Scanner</li>
<li><strong>Script:</strong> Copy the below snipplet</li>
</ol>
<p><div class="highlight"><pre><span></span><code>      <span class="cm">&lt;#</span>
<span class="cm">       </span><span class="sd">.SYNOPSIS</span><span class="cm"></span>
<span class="cm">       Discovery script for finding all SQL Logins on a the target machine</span>
<span class="cm">       </span><span class="sd">.EXAMPLE</span><span class="cm"></span>
<span class="cm">       Expected arguments: $TARGET $[1]$DOMAIN $[1]$USERNAME $[1]$PASSWORD</span>
<span class="cm">       </span><span class="sd">.EXAMPLE</span><span class="cm"></span>
<span class="cm">       Expected arguments: $TARGET $[1]$USERNAME $[1]$PASSWORD</span>
<span class="cm">       Use lines 32/33 or 36/37 based on account type</span>
<span class="cm">       </span><span class="sd">.NOTES</span><span class="cm"></span>
<span class="cm">       Depends upon dbatools module being installed on the Secret Server Web Node or the Distributed Engine</span>
<span class="cm">       Reference: https://www.powershellgallery.com/packages/dbatools/</span>
<span class="cm">       Tested with version 1.0.107</span>
<span class="cm">       logPath variable below used for troubleshooting if required, file is written to this path with errors.</span>
<span class="cm">       A file for each server will be created, and overwritten on each run.</span>
<span class="cm">   #&gt;</span>
   <span class="nv">$logPath</span> <span class="p">=</span> <span class="s1">&#39;C:\scripts&#39;</span>
   <span class="nb">echo </span><span class="nv">$args</span><span class="p">[</span><span class="n">1</span><span class="p">]+</span><span class="s2">&quot;\&quot;</span><span class="p">+</span><span class="nv">$args</span><span class="p">[</span><span class="n">2</span><span class="p">]</span>
   <span class="nv">$TargetServer</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$args</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))[</span><span class="n">0</span><span class="p">]</span>

   <span class="nv">$logFile</span> <span class="p">=</span> <span class="s2">&quot;$logPath\</span><span class="p">$(</span><span class="nv">$TargetServer</span><span class="p">)</span><span class="s2">_findsqllogins.txt&quot;</span>
   <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Processing Targeting machine: $TargetServer&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>

   <span class="cm">&lt;# Based on credential type of argument #&gt;</span>
   <span class="c"># Windows Domain with domain name</span>
   <span class="nv">$Username</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">1</span><span class="p">]+</span><span class="s2">&quot;\&quot;</span><span class="p">+</span><span class="nv">$args</span><span class="p">[</span><span class="n">2</span><span class="p">]</span>
   <span class="nv">$Password</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">3</span><span class="p">]</span>

   <span class="c"># Windows Domain without domain name</span>
   <span class="c">#$Username = $args[1]</span>
   <span class="c">#$Password = $args[2]</span>

   <span class="c"># Using SQL Login Account privileged account</span>
   <span class="c"># $Username = $params[1]</span>
   <span class="c"># $Password = $params[2]</span>

   <span class="k">if</span> <span class="p">(</span> <span class="nv">$Username</span> <span class="o">-and</span> <span class="nv">$Password</span> <span class="p">)</span> <span class="p">{</span>
       <span class="nv">$passwd</span> <span class="p">=</span> <span class="nv">$Password</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
       <span class="nv">$sqlCred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-ArgumentList</span> <span class="nv">$Username</span><span class="p">,</span><span class="nv">$passwd</span>
       <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Using Privileged Account: </span><span class="p">$(</span><span class="nv">$sqlCred</span><span class="p">.</span><span class="n">Username</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
   <span class="p">}</span>

   <span class="nv">$ProgressPreference</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-InstalledModule</span> <span class="n">dbatools</span><span class="p">))</span> <span class="p">{</span>
       <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] dbatools module not found&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
       <span class="k">throw</span> <span class="s2">&quot;The module dbatools is required for this script. Please run &#39;Install-Module dbatools&#39; in an elevated session on your Distributed Engine and/or Web Node.&quot;</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nb">Import-Module</span> <span class="n">dbatools</span> <span class="n">-Force</span>
       <span class="cm">&lt;# disable dbatools commands attempting to resolve the target name #&gt;</span>
       <span class="nv">$null</span> <span class="p">=</span> <span class="nb">Set-DbatoolsConfig</span> <span class="n">-FullName</span> <span class="n">commands</span><span class="p">.</span><span class="nb">resolve-dbanetworkname</span><span class="p">.</span><span class="n">bypass</span> <span class="n">-Value</span> <span class="nv">$true</span>
   <span class="p">}</span>

   <span class="cm">&lt;# Find all the SQL Server instances #&gt;</span>
   <span class="k">try</span> <span class="p">{</span>
       <span class="cm">&lt;# Depends upong Discovery Account #&gt;</span>
       <span class="nv">$p</span> <span class="p">=</span> <span class="p">@{</span>
           <span class="n">ComputerName</span>    <span class="p">=</span> <span class="nv">$TargetServer</span>
           <span class="n">ScanType</span>        <span class="p">=</span> <span class="s1">&#39;SqlService&#39;</span>
           <span class="n">EnableException</span> <span class="p">=</span> <span class="nv">$true</span>
       <span class="p">}</span>
       <span class="nv">$sqlEngines</span> <span class="p">=</span> <span class="nb">Find-DbaInstance</span> <span class="nv">@p</span>
       <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] SQL Instances found: </span><span class="p">$(</span><span class="nv">$sqlEngines</span><span class="p">.</span><span class="n">SqlInstance</span> <span class="n">-join</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
   <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$logPath</span><span class="p">)</span> <span class="p">{</span>
           <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue finding SQL Instances on $TargetServer - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
       <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
           <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue finding SQL Instances on $TargetServer - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span>
       <span class="p">}</span>
       <span class="k">throw</span> <span class="s2">&quot;Issue finding SQL instances on $TargetServer - $_&quot;</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="nv">$sqlEngines</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$engine</span> <span class="k">in</span> <span class="nv">$sqlEngines</span><span class="p">)</span> <span class="p">{</span>
           <span class="nv">$sqlInstanceValue</span> <span class="p">=</span> <span class="nv">$engine</span><span class="p">.</span><span class="n">SqlInstance</span>
           <span class="k">try</span> <span class="p">{</span>
               <span class="cm">&lt;#</span>
<span class="cm">                   Connect to each instance found</span>
<span class="cm">               #&gt;</span>
               <span class="nv">$p</span> <span class="p">=</span> <span class="p">@{</span>
                   <span class="n">SqlInstance</span>   <span class="p">=</span> <span class="nv">$sqlInstanceValue</span>
                   <span class="n">SqlCredential</span> <span class="p">=</span> <span class="nv">$sqlCred</span>
                   <span class="n">ErrorAction</span>   <span class="p">=</span> <span class="s1">&#39;Stop&#39;</span>
               <span class="p">}</span>
               <span class="k">try</span> <span class="p">{</span>
                   <span class="nv">$cn</span> <span class="p">=</span> <span class="nb">Connect-DbaInstance</span> <span class="nv">@p</span>
                   <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Connected to SQL Server Instance: $sqlInstanceValue&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
               <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
                   <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$logPath</span><span class="p">)</span> <span class="p">{</span>
                       <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue connecting to $sqlInstanceValue - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
                   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                       <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue connecting to $sqlInstanceValue - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span>
                   <span class="p">}</span>
                   <span class="k">continue</span>
               <span class="p">}</span>

               <span class="cm">&lt;#</span>
<span class="cm">                   Find the logins on the instance</span>
<span class="cm">               #&gt;</span>
               <span class="nv">$p</span> <span class="p">=</span> <span class="p">@{</span>
                   <span class="n">SqlInstance</span>     <span class="p">=</span> <span class="nv">$cn</span>
                   <span class="nb">Type </span>           <span class="p">=</span> <span class="s1">&#39;SQL&#39;</span>
                   <span class="n">ExcludeFilter</span>   <span class="p">=</span> <span class="s1">&#39;##*&#39;</span>
                   <span class="n">EnableException</span> <span class="p">=</span> <span class="nv">$true</span>
               <span class="p">}</span>
               <span class="nv">$logins</span> <span class="p">=</span> <span class="nb">Get-DbaLogin</span> <span class="nv">@p</span>
               <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] SQL Server Logins count: </span><span class="p">$(</span><span class="nv">$logins</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
           <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$logPath</span><span class="p">)</span> <span class="p">{</span>
                   <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$logFile</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$append</span> <span class="p">=</span> <span class="nv">$true</span> <span class="p">}</span>
                   <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue connecting to $sqlInstanceValue - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Append</span><span class="p">:</span><span class="nv">$append</span>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                   <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] Issue connecting to $sqlInstanceValue - </span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span><span class="s2">&quot;</span>
               <span class="p">}</span>
               <span class="k">continue</span>
           <span class="p">}</span>

           <span class="cm">&lt;# Output object for Discovery #&gt;</span>
           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$login</span> <span class="k">in</span> <span class="nv">$logins</span><span class="p">)</span> <span class="p">{</span>
               <span class="nb">Write-Output</span> <span class="s2">&quot;[</span><span class="p">$(</span><span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="n">yyyyMMdd</span><span class="p">)</span><span class="s2">] SQL Server Login found: $login&quot;</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$logFile</span> <span class="n">-Force</span>
               <span class="no">[PSCustomObject]</span><span class="p">@{</span>
                   <span class="n">Machine</span>  <span class="p">=</span> <span class="nv">$login</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">Name</span>
                   <span class="n">Username</span> <span class="p">=</span> <span class="nv">$login</span><span class="p">.</span><span class="n">Name</span>
               <span class="p">}</span>
           <span class="p">}</span>
           <span class="k">return</span> <span class="no">[PSCustomObject]</span>
       <span class="p">}</span>
   <span class="p">}</span>
</code></pre></div>
2. Click <strong>Ok</strong></p>
<h2 id="create-a-new-scan-template">Create a new scan template</h2>
<ol>
<li>Navigate to <strong>Adminitration &gt;&gt; &gt;Actions &gt; Discovery</strong></li>
<li>Open the <strong>Configuration</strong> tab</li>
<li>Click <strong>Discovery Configuration Options &gt; Extensible Discovery</strong></li>
</ol>
<p><img alt="Scantemplates" src="../images/ss-adv-0097.png" /></p>
<ol>
<li>Click in the <em>Scan Templates</em> <strong>Configure Scan Templates</strong> and open the <strong>Accounts</strong> tab</li>
<li>Click <strong>+ Create New Scan Template</strong></li>
<li>
<p>Use the following parameters for the new screen that appears:</p>
</li>
<li>
<p><strong>Name:</strong> SQL Logins</p>
</li>
<li><strong>Scan Type:</strong> no change</li>
<li><strong>Parent Scan Template:</strong> no change</li>
<li>
<p><strong>FIELD NAME</strong> Fill out the following</p>
<p><strong>Machine</strong>
  <strong>Username</strong></p>
</li>
</ol>
<p>The configuration should look like the below screenshot:</p>
<p><img alt="Scantemplates" src="../images/ss-adv-0098.png" /></p>
<ol>
<li>Click <strong>Save</strong></li>
</ol>
<h2 id="create-a-new-discovery-scanner">Create a new Discovery scanner</h2>
<ol>
<li>Navigate to <strong>Adminitration &gt;&gt; &gt;Actions &gt; Discovery</strong></li>
<li>Open the <strong>Configuration</strong> tab</li>
<li>Click <strong>Discovery Configuration Options &gt; Extensible Discovery</strong></li>
<li>In the <em>Discovery Scanners</em> section click <strong>Configure Discovery Scanners</strong></li>
<li>Click the <strong>Accounts</strong> tab and click <strong>+ Create New Scanner</strong></li>
<li>
<p>Provide the following parameters for the new scanner</p>
</li>
<li>
<p><strong>Name:</strong> SQL Login Discovery Scanner</p>
</li>
<li><strong>Description:</strong> SQL Login Discovery Scanner</li>
<li><strong>Active:</strong> Checked</li>
<li><strong>Discovery Type:</strong> Find Local Accounts</li>
<li><strong>Base Scanner:</strong> PowerShell Discovery</li>
<li><strong>Allow OU Input:</strong> unchecked</li>
<li><strong>Input Template:</strong> Windows Computer</li>
<li><strong>Output Template:</strong> SQL Login</li>
<li><strong>Script:</strong> SQL Login Discovery</li>
<li><strong>Script Arguments:</strong> $target $[1]$Domain $[1]$Username $[1]$Password</li>
</ol>
<p><img alt="Scantemplates" src="../images/ss-adv-0100.png" /></p>
<ol>
<li>Click <strong>Ok</strong></li>
</ol>
<h2 id="run-the-new-discovery-scanner">Run the new Discovery Scanner</h2>
<p>Now that we have paved the way, we need to tell the Discovery Scanner to also run the new Scanner.</p>
<ol>
<li>Navigate to <strong>Administration &gt;&gt; &gt; Discovery</strong></li>
<li>Click the <strong>thylab.local</strong> domain and click <strong>Scanner Settings</strong></li>
</ol>
<p><img alt="Scantemplates" src="../images/ss-adv-0101.png" /></p>
<ol>
<li>In the <em>FIND ACCOUNTS</em> section, click <strong>+Add New Account Scanner</strong></li>
<li>Click on the <strong>+</strong> symbol to add the scanner</li>
</ol>
<p><img alt="Scantemplates" src="../images/ss-adv-0102.png" /></p>
<ol>
<li>Click <strong>OK</strong></li>
<li>The new scanner should be mentioned in the list of <em>FIND ACCOUNTS</em></li>
</ol>
<p><img alt="Scantemplates" src="../images/ss-adv-0104.png" /></p>
<ol>
<li>Click the <strong>BACK</strong> button the return back to the domain</li>
<li>In the top of the screen, click <strong>Admin &gt; Discovery</strong></li>
<li>Click <strong>Run Discovery Now &gt; Run Computer Scan</strong> to run the scanner including the SQL Scanner</li>
<li>Wait till the Computer Scan has ended. It should read <strong>Just Now</strong></li>
<li>Click on <strong>Discovery Network View</strong></li>
<li>In the new window, make sure you have <strong>Local Accounts</strong> selected and click <strong>Computers</strong> in the <strong>thylab.local</strong> domain</li>
<li>
<p>In the Line that shows SSPM you will see the <strong>sa</strong> account and <strong>SQL Login</strong> as the scan template</p>
<p><img alt="Scantemplates" src="../images/ss-adv-0106.png" /></p>
</li>
<li>
<p>Click <strong>Back</strong> to return back to the Discovery overview</p>
</li>
</ol>
<hr />
<p><strong>Remark</strong></p>
<p>Using this method, Extensible (custom) Discovery, anything that can be "discovered" by using a PowerShell script, can be created for resources which are not available Out-Off-The-Box. To read more on Extensible (Custom) Discovery, including some examples, can be found <a href="https://docs.thycotic.com/ss/11.1.0/discovery/extensible-discovery/index.md">here</a>.</p>
<hr />
<HR>
<p><center><H1 style="color:#00FF59">This concludes this part of the lab</H1></center></p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../lab7/lab7/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Hooks in secrets" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Hooks in secrets
            </div>
          </div>
        </a>
      
      
        
        <a href="../../lab9/lab9/" class="md-footer__link md-footer__link--next" aria-label="Next: Custom Remote Password Changer" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Custom Remote Password Changer
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>